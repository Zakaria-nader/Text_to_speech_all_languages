<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>تحويل النص إلى صوت مع دعم عربي مرتب</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #282c34;
    color: #eee;
  }
  textarea {
    width: 100%;
    height: 150px;
    font-size: 18px;
    border-radius: 8px;
    padding: 10px;
  }
  select, button {
    padding: 10px;
    font-size: 16px;
    margin-top: 10px;
    border-radius: 8px;
    border: none;
  }
  button {
    background-color: #4caf50;
    color: white;
    cursor: pointer;
    width: 100%;
  }
</style>
</head>
<body>

<h2>تحويل النص إلى صوت مع دعم عربي مرتب</h2>

<textarea id="text" placeholder="اكتب النص هنا..."></textarea>

<select id="voiceSelect"></select>

<button id="speakBtn">تشغيل الصوت</button>

<script>
  const synth = window.speechSynthesis;
  const textArea = document.getElementById('text');
  const voiceSelect = document.getElementById('voiceSelect');
  const speakBtn = document.getElementById('speakBtn');

  let voices = [];

  // خريطة لترجمة رموز اللغات لأسماء عربية واضحة
  const langMap = {
    "ar-SA": "العربية (السعودية)",
    "ar-EG": "العربية (مصر)",
    "ar-AE": "العربية (الإمارات)",
    "ar-IQ": "العربية (العراق)",
    "ar": "العربية",
    "en-US": "الإنجليزية (الولايات المتحدة)",
    "en-GB": "الإنجليزية (بريطانيا)",
    "fr-FR": "الفرنسية (فرنسا)",
    "es-ES": "الإسبانية (إسبانيا)",
    "de-DE": "الألمانية (ألمانيا)",
    "it-IT": "الإيطالية (إيطاليا)",
    "ja-JP": "اليابانية (اليابان)",
    "ko-KR": "الكورية (كوريا)",
    "zh-CN": "الصينية (الصين)",
    "ru-RU": "الروسية (روسيا)"
  };

  function getLangName(code) {
    // ارجع الاسم المعرب، أو الرمز نفسه لو مش موجود في الخريطة
    return langMap[code] || code;
  }

  function populateVoices() {
    voices = synth.getVoices();
    voiceSelect.innerHTML = '';

    // ترتيب الأصوات حسب اللغة مع الترجمة
    voices.forEach((voice, i) => {
      const langName = getLangName(voice.lang);
      const option = document.createElement('option');
      option.value = i;
      option.textContent = `${voice.name} — ${langName}`;
      voiceSelect.appendChild(option);
    });

    // اختيار أول صوت عربي تلقائي لو موجود
    const arabicVoiceIndex = voices.findIndex(v => v.lang.startsWith('ar'));
    if (arabicVoiceIndex >= 0) {
      voiceSelect.selectedIndex = arabicVoiceIndex;
    }
  }

  synth.onvoiceschanged = populateVoices;

  speakBtn.addEventListener('click', () => {
    const text = textArea.value.trim();
    if (!text) {
      alert('يرجى إدخال نص.');
      return;
    }
    const utterThis = new SpeechSynthesisUtterance(text);
    const selectedVoice = voices[voiceSelect.value];
    if (selectedVoice) {
      utterThis.voice = selectedVoice;
      utterThis.lang = selectedVoice.lang;
    }
    synth.cancel();
    synth.speak(utterThis);
  });

  // شغل تحميل الأصوات فوراً
  populateVoices();
</script>

</body>
</html>
